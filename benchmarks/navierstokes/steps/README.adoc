= Navier-Stokes benchmark
Feel++ Consortium <feelpp-devel@feelpp.org>
v1.0, 2015-07-05
:toc:
:math:
:latex:


== Backward step

=== Execute

```shell
# 2D
mpirun -np 16 ./feelpp_steady_ns_2d
# 3D
mpirun -np 16 ./feelpp_steady_ns_3d
```

=== Boundary conditions

Edit the .bc files

== FDA Benchmark

[[img-fda]]
.FDA Device Geometry
image::fda-1.png[FDA, 300]

=== Purpose

The following is taken from  link:http://www.fda.gov/ScienceResearch/SpecialTopics/CriticalPathInitiative/SpotlightonCPIProjects/ucm149414.htm[Reference website] and references <<Stewart>>, <<passerini>>.

The purpose of this project is to determine how computational fluid dynamics can be effectively used to characterize fluid flow and to predict blood damage in medical devices. To address this complex issue, FDA has partnered with academia and industry under the Critical Path Initiative program to advance the application of CFD technology in the development and evaluation of medical devices.

=== Application

To execute the 3D FDA benchmark, run the following command
```
mpirun -np <np> feelpp_unsteady_fda_3D --config-file fda_3d.cfg
```

Parameters in the config file:
- Mesh File. It is strongly advised to generate the mesh file and its partitioning before executing the code
```
gmsh.filename=<mesh file>.msh
```

=== Configurations

We consider three flow regimes $Re_t=500, 2000, 3500$ as described in Table <<TableRe>>. For each flow regime we compute quantities of interest at various sections of the domain. These sections are given by Figure <<FDASections>>.

[[TableRe]]
.Throat Reynolds number $Re_t$ , inlet Reynolds number $Re_i$ , and flow rate for the flow regimes under consideration.
[width="80%",options="header",cols=">,>,>"]
|===================
|$￼Re_t$| $Re_i$  | Flow rate $Q$ ($$m^3/s$$)
|500 | 167  |5.2062e􏰙-6
|2000 | 667  |2.0825e􏰙-5
|3500 | 1167 |3.6444e􏰙-5
|===================
￼￼
[FDASections]
.Radial sections at which the numerical results are compared with the experimental measurements.
image::fda-sections.png[FDA Sections, 300]

. The quantities of interest are
 - The axial component of the velocity stem:[u^{norm}_z] is normalized with respect to the average axial velocity at the inlet $\bar{u}_i$ :
\[
u^{\mathrm{norm}}_z = \frac{u_z}{\bar{u}_i} \text{ with } \bar{u}_i=\frac{Q}{\pi D_i^2/4}.
\]

The geometry was retrieved by extruding the 2D section  (see figure <<2Dsection>>) 4 times.
image::2Dsection.png[FDA Sections, 300]

Regarding $Re_t=500$, we shall consider the meshes described in Table <<TableMeshesRe500>>.

[[TableMeshesRe500]]
.List of meshes for $$Re=500$$ generated by Gmsh
[width="60%",options="header"]
|======
| Name    | $h_{max}$| $h_{min}$| $h_{avg}$|  #Tetrahedrons| #Vertices| $P1bP1_{DOF}$| $P2P1_{DOF}$|$P3P2_{DOF}$
| $M_0$ |   0.01| 7.5e-3| 6.9e-3| -| -| –| -| -
| $M_1$ | 1.8e-3| 1.7e-4| 6.9e-4| 830.000| 170.000| 1.510.000| 3.926.863| 13.716.257
| $M_2$ | 1.9e-3| 1.3e-4| 4.5e-4| 3.400.000| 630.000| 5.920.000| -| -
| $M_3$ | 1.8e-3| 9.2e-5| 3.4e-4| 7.000.000| 1.300.000| 12.200.000| 30.897.292| -
|======
For $$Re=500$$ the simulations run up to 3s with $$\Delta t=10^{-3}$$
[[TableMeshesRe2000]]
.List of meshes for $$Re=2000$$ generated by Gmsh
[width="60%",options="header"]
|======
| Name    | $h_{max}$| $h_{min}$| $h_{avg}$|  #Tetrahedrons| #Vertices| $P2P1_{DOF}$|$P3P2_{DOF}$ 
| $M_{2000}$ | 4.5e-3| 2.1e-4| 7.1e-4| 2.500.000 | 460.000| 5440000| 11294263| -
|======
For $$Re2000$$ the simulations run up to 0.45s with $$\Delta t=10^{-4}$$

[[TableMeshesRe3500]]
.List of meshes for $$Re=3500$$ generated by Gmsh
[width="60%",options="header"]
|======
| Name    | $h_{max}$| $h_{min}$| $h_{avg}$|  #Tetrahedrons| #Vertices| $P2P1_{DOF}$|$P3P2_{DOF}$ 
| $M_{3500}$ | 2.5e-3| 1.4e-4| 8.4e-4| 3.200.000 | 560.000| - | -
|======
For $$Re=3500$$ the simulations run up to 0.4s with $$\Delta t=10^{-4}$$

[[TableTime]]
.Computational $$Re=500, 2000, 3500$$
[width="60%",options="header"]
|======
| Name  | #Core | $$T (h)$$
| $M_1$ | 32    | 15.5
| $M_2$ | 128    | 24
| $M_3$ | 256    | 256
| $M_{2000}$ | - | -
| $M_{3500}$ | 256 | 336
|======

:numbered:
[bibliography]
=== FDA Bibliography

[bibliography]
- [[[Stewart]]] Stewart, SandyF.C. Paterson, EricG. Burgreen, GregW. Hariharan, Prasanna Giarra, Matthew Reddy, Varun Day, StevenW. Manning, KeefeB. Deutsch, Steven Berman, MichaelR. Myers, MatthewR. Malinauskas, RichardA. 'Assessment of CFD Performance in Simulations of an Idealized Medical Device: Results of FDA’s First Computational Interlaboratory Study'. Cardiovascular Engineering and Technology. June 2012, Volume 3, Issue 2, pp 139-160.
- [[[passerini]]] T. Passerini, A. Quaini, U. Villa, A. Veneziani and S. Canic 'Validation of an open source framework for the simulation of blood flow in rigid and deformable vessels.' INTERNATIONAL JOURNAL FOR NUMERICAL METHODS IN BIOMEDICAL ENGINEERING Int. J. Numer. Meth. Biomed. Engng. (2013) Published online in Wiley Online Library (wileyonlinelibrary.com). DOI: 10.1002/cnm.2568
